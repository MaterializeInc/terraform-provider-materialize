---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "materialize_sink_iceberg Resource - terraform-provider-materialize"
subcategory: ""
description: |-
  An Iceberg sink writes data from Materialize to an Apache Iceberg table stored in object storage.
---

# materialize_sink_iceberg (Resource)

An Iceberg sink writes data from Materialize to an Apache Iceberg table stored in object storage.

## Example Usage

```terraform
# Create an Iceberg sink to export data to AWS S3 Tables
resource "materialize_sink_iceberg" "example" {
  name         = "iceberg_sink"
  cluster_name = "quickstart"

  from {
    name          = "my_materialized_view"
    database_name = "materialize"
    schema_name   = "public"
  }

  iceberg_catalog_connection {
    name          = "iceberg_catalog_connection"
    database_name = "materialize"
    schema_name   = "public"
  }

  namespace = "my_namespace"
  table     = "my_table"

  aws_connection {
    name          = "aws_connection"
    database_name = "materialize"
    schema_name   = "public"
  }

  key              = ["id"]
  key_not_enforced = true
  commit_interval  = "10s"
}

# CREATE SINK iceberg_sink
#   IN CLUSTER quickstart
#   FROM my_materialized_view
#   INTO ICEBERG CATALOG CONNECTION iceberg_catalog_connection (
#     NAMESPACE = 'my_namespace',
#     TABLE = 'my_table'
#   )
#   USING AWS CONNECTION aws_connection
#   KEY (id) NOT ENFORCED
#   MODE UPSERT
#   WITH (COMMIT INTERVAL = '10s');


# Example with multiple key columns
resource "materialize_sink_iceberg" "multi_key_example" {
  name         = "iceberg_sink_multi_key"
  cluster_name = "quickstart"

  from {
    name          = "orders"
    database_name = "materialize"
    schema_name   = "public"
  }

  iceberg_catalog_connection {
    name          = "iceberg_catalog_connection"
    database_name = "materialize"
    schema_name   = "public"
  }

  namespace = "sales"
  table     = "orders_table"

  aws_connection {
    name          = "aws_connection"
    database_name = "materialize"
    schema_name   = "public"
  }

  key             = ["order_id", "tenant_id"]
  commit_interval = "1m"
}

# CREATE SINK iceberg_sink_multi_key
#   IN CLUSTER quickstart
#   FROM orders
#   INTO ICEBERG CATALOG CONNECTION iceberg_catalog_connection (
#     NAMESPACE = 'sales',
#     TABLE = 'orders_table'
#   )
#   USING AWS CONNECTION aws_connection
#   KEY (order_id, tenant_id)
#   MODE UPSERT
#   WITH (COMMIT INTERVAL = '1m');
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `aws_connection` (Block List, Min: 1, Max: 1) The AWS connection for object storage access. (see [below for nested schema](#nestedblock--aws_connection))
- `commit_interval` (String) How frequently to commit snapshots to Iceberg (e.g., '10s', '1m'). Required for Iceberg sinks.
- `from` (Block List, Min: 1, Max: 1) The name of the source, table or materialized view you want to send to the sink. (see [below for nested schema](#nestedblock--from))
- `iceberg_catalog_connection` (Block List, Min: 1, Max: 1) The name of the Iceberg catalog connection to use. (see [below for nested schema](#nestedblock--iceberg_catalog_connection))
- `key` (List of String) The columns that uniquely identify rows. Required for Iceberg sinks.
- `name` (String) The identifier for the sink.
- `namespace` (String) The Iceberg namespace (database) containing the table.
- `table` (String) The name of the Iceberg table to write to. If the table doesn't exist, Materialize creates it with a schema matching the source.

### Optional

- `cluster_name` (String) The cluster to maintain this sink.
- `comment` (String) Comment on an object in the database.
- `database_name` (String) The identifier for the sink database in Materialize. Defaults to `MZ_DATABASE` environment variable if set or `materialize` if environment variable is not set.
- `key_not_enforced` (Boolean) Disable Materialize's validation of the key's uniqueness. Use only when you have outside knowledge that the key is unique.
- `ownership_role` (String) The ownership role of the object.
- `region` (String) The region to use for the resource connection. If not set, the default region is used.
- `schema_name` (String) The identifier for the sink schema in Materialize. Defaults to `public`.

### Read-Only

- `id` (String) The ID of this resource.
- `qualified_sql_name` (String) The fully qualified name of the sink.
- `size` (String) The size of the cluster maintaining this sink.

<a id="nestedblock--aws_connection"></a>
### Nested Schema for `aws_connection`

Required:

- `name` (String) The aws_connection name.

Optional:

- `database_name` (String) The aws_connection database name. Defaults to `MZ_DATABASE` environment variable if set or `materialize` if environment variable is not set.
- `schema_name` (String) The aws_connection schema name. Defaults to `public`.


<a id="nestedblock--from"></a>
### Nested Schema for `from`

Required:

- `name` (String) The from name.

Optional:

- `database_name` (String) The from database name. Defaults to `MZ_DATABASE` environment variable if set or `materialize` if environment variable is not set.
- `schema_name` (String) The from schema name. Defaults to `public`.


<a id="nestedblock--iceberg_catalog_connection"></a>
### Nested Schema for `iceberg_catalog_connection`

Required:

- `name` (String) The iceberg_catalog_connection name.

Optional:

- `database_name` (String) The iceberg_catalog_connection database name. Defaults to `MZ_DATABASE` environment variable if set or `materialize` if environment variable is not set.
- `schema_name` (String) The iceberg_catalog_connection schema name. Defaults to `public`.
